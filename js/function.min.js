(function(h){var b=h(document);var e=h(window);var c;var j,f,a,l;var k,d,i;var g={windowWidth:null,columnWidth:null,timer:null,page:0,even:true,loading:false};b.ready(function(){c=h("#canvas");j=h("#header");f=h("#main");a=h("#nav");l=h("footer");k=h("#title");e.bottom({proximity:0.001}).on("resize",function(){clearTimeout(g.timer);g.timer=setTimeout(function(){v();if(g.page){f.masonry({columnWidth:g.columnWidth})}},250)}).on("bottom",function(){clearTimeout(g.timer);g.timer=setTimeout(function(){if(i.length&&!g.loading){g.loading=true;u()}},250)});b.on("pjax:success",p);h("[data-pjax] a, a[data-pjax]").on("click",r);function q(){if(!g.page&&f.hasClass("masonry")){f.masonry("destroy");g.even=true}d=h("#column");i=h("#next");v();if(d.length){var y=f.find(".item").not(".masonry-brick");var x=[];y.each(function(){x.push(h(this)[0])}).remove();x.sort(function(){return Math.random()-Math.random()});f.append(x);y=f.find(".item").not(".masonry-brick");y.find("[data-pjax] a, a[data-pjax]").on("click",r);for(var z=0,w=y.length;z<w;z++){var A=y.eq(z);A.hover(o.bind(A),t.bind(A));if(g.even&&0.8<Math.random()){A.addClass("x2")}else{g.even=!g.even}}if(g.page){f.masonry("option",{isAnimated:false}).masonry("appended",y).masonry("option",{isAnimated:true})}else{f.masonry({itemSelector:".item",isAnimated:false,isResizable:false,columnWidth:g.columnWidth,containerStyle:{position:"absolute"},animationOptions:{duration:500,easing:"easeOutQuint"}}).masonry().masonry("option",{isAnimated:true});g.page++}}i.appendTo(f);d.empty()}function v(){g.windowWidth=e.width();g.columnWidth=d.width()}function r(x){if(!g.loading){x.preventDefault();var w=this.href;g.page=0;g.loading=true;s();setTimeout(function(){h.pjax({url:w,container:"#main",fragment:"#main",timeout:5000})},500)}}function p(){f.imagesLoaded(function(){setTimeout(function(){q();m()},250)})}function u(){g.page++;s();setTimeout(function(){var w=location.href+"page"+g.page+"/";i.remove();h.pjax({url:w,container:"#column",fragment:"#main",scrollTo:false,push:false,timeout:99999})},750)}h.fn.toggleElement=function(){if(this.hasClass("hidden")){this.removeClass("hidden")}else{this.addClass("hidden")}return this};function o(){if(!g.loading){var w=this.find("h1").text();var x=this.find("p").text();k.text(w)}}function t(){if(!g.loading){k.text("eilery.com")}}function s(){k.text("Loading...");c.velocity({right:0},{duration:500,easing:"easeInQuint"})}function m(){k.text("Loaded.");c.velocity({left:g.windowWidth},{duration:500,easing:"easeOutQuint",complete:function(){c.css("left","0").css("right","100%");setTimeout(function(){g.loading=false;k.text("eilery.com")},250)}})}function n(){s();setTimeout(function(){j.toggleElement();f.toggleElement();l.toggleElement();a.toggleElement();p()},500)}n()})})(jQuery);
